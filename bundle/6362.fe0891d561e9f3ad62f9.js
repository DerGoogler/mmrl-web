"use strict";(self.webpackChunkcom_dergoogler_mmrl_web=self.webpackChunkcom_dergoogler_mmrl_web||[]).push([[6362],{790897:(e,t,r)=>{r.r(t),r.d(t,{InstallTerminalV2Activity:()=>D,default:()=>B});var o=r(474848),n=r(676437),s=r(719907),a=r(993328),i=r(513272),l=r(191241),m=r(714992),c=r(130995),d=r(24279),u=r(233551),p=r(222112),g=r(507548),h=r.n(g),x=r(296540),E=r(195545),b=r(115241),f=r(538297),R=r(278567),L=r(838206),_=r(296857),I=r(851629),M=r(369907),A=r(964483),v=r(882326),S=r(448043),w=r(734853);const C=x.createContext({processCommand:e=>"",lines:[],setLines(){},addButton(e,t){},addText(e,t){},setLastLine(e,t){},rebootDevice(e){},getInstallCLI:e=>"exit "+M.$.TERM_INTR_ERR,clearTerminal(){}}),$={R:"[0m",BRIGHT:"[1m",DIM:"[2m",UNDERSCORE:"[4m",FG:{BLACK:"[30m",RED:"[31m",GREEN:"[32m",YELLOW:"[33m",BLUE:"[34m",MAGENTA:"[35m",CYAN:"[36m",WHITE:"[37m",GRAY:"[90m"},BG:{BLACK:"[40m",RED:"[41m",GREEN:"[42m",YELLOW:"[43m",BLUE:"[44m",MAGENTA:"[45m",CYAN:"[46m",WHITE:"[47m",GRAY:"[100m"}},N=e=>{const{strings:t}=(0,_.k)(),{modFS:r,modFSParse:n}=(0,L.vQ)(),[s,a]=x.useState(!1),[i,l]=x.useState([]),m=(0,S.SC)(),{children:c}=e,d=(e,t)=>{const r=h(e);"string"==typeof r&&"undefined"!==r&&l((e=>[...e,{component:f.A,props:{children:r,sx:{mr:1,ml:1},linkify:!0,...t}}]))},u=(e,t)=>{l((e=>e.slice(0,-1))),d(e,t)},p=(e,t)=>{l((r=>[...r,{component:I.A,props:{children:e,variant:"contained",sx:{width:"50vmin",mt:1,mb:1},...t}}]))},g=x.useMemo((()=>({addImage:e=>(((e,t)=>{"string"==typeof e&&l((r=>[...r,{component:R._,props:{src:e,noOpen:!0,sx:{mr:1,ml:1},...t}}]))})(e),"undefined"),setLastLine:e=>(void 0===e||u(e),"undefined"),color:e=>void 0===e?"undefined":w.default.format(e,$),clearTerminal:()=>(l([]),"undefined"),removeLastLine:()=>(l((e=>e.slice(0,-1))),"undefined")})),[]),h=e=>{if(e.startsWith("#!mmrl:"))return e=e.substring(7),w.default.format(e,g);{const t=/^\-(\s+)?(.+)/gm,r=/^\?(\s+)?(.+)/gm,o=/^\!(\s+)?(.+)/gm;return e.match(t)?e.replace(t,"$2"):e.match(o)?e.replace(o,"[31m$2[0m"):e.match(r)?e.replace(r,"[33m$2[0m"):e}},E=x.useCallback(((e="")=>{m({title:t("reboot_device"),description:t("reboot_device_desc"),confirmationText:t("yes"),cancellationText:t("cancel")}).then((()=>{M.$.cmd(`/system/bin/svc power reboot ${e} || /system/bin/reboot ${e}`).exec()}))}),[]),b=x.useCallback((e=>{const t={...e,findBinary(e,t){const r=["/system/bin","<ADB>/ksu/bin","<ADB>/ap/bin","<ADB>/magisk"],o=e.split(",");for(const e of o)for(const o of r){const r=n(v.A.join(o,e));if(A.j.exist(r))return`${r} ${t}`}return null}};switch(M.$.getRootManager()){case"Magisk":return r("MSUINI",t);case"KernelSU":return r("KSUINI",t);case"APatchSU":return r("ASUINI",t);default:return`exit ${M.$.M_DWL_FAILURE}`}}),[]),N=()=>{l([])},k=x.useMemo((()=>({processCommand:h,lines:i,setLines:l,addButton:p,addText:d,setLastLine:u,rebootDevice:E,getInstallCLI:b,clearTerminal:N})),[h,i,l,s,a,p,d,u,E,b,N]);return(0,o.jsx)(C.Provider,{value:k,children:c})},k=()=>x.useContext(C);var T=r(753649),y=r(53295),j=r(906627);const U=()=>{const{context:e,extra:t}=(0,a.v5)(),r=x.useRef(null),{clearTerminal:g,lines:f}=k(),[R]=(0,i.t)("term_scroll_bottom"),[L]=(0,i.t)("term_scroll_behavior"),[_]=(0,i.t)("terminal_word_wrap"),[I]=(0,i.t)("terminal_numberic_lines");if(R){const e=x.useMemo((()=>L),[L]);x.useEffect((()=>{r.current?.scrollIntoView({behavior:e.value,block:"end",inline:"nearest"})}),[f])}const[v,S]=(()=>{const e="/data/local/tmp",{extra:t}=(0,a.v5)(),[r,n]=x.useState(0),[s]=(0,i.t)("print_terminal_error"),{addText:l,addButton:m,setLastLine:c,rebootDevice:d,getInstallCLI:u}=k(),{source:p,issues:g}=t;return[async t=>new Promise(((r,a)=>{const i=t.url,h=t.printExit??!0,x=`${e}/${(0,E.A)()}.zip`;console.debug(x);const f=new b.f(i,x);f.onChange=t=>{switch(t.type){case"downloading":n(t.state),c(`- Downloading module progress: ${t.state}%`);break;case"finished":n(0);const i=new T.B({cwd:e,printError:s});i.env={ASH_STANDALONE:"1",MMRL:"true",MMRL_INTR:"true",MMRL_VER:y.P.VERSION_CODE.toString(),ROOTMANAGER:M.$.getRootManager()},i.onLine=e=>{l(e)},s&&(i.onError=e=>{l(`[38;5;130mâ“˜${e}`)}),i.onExit=e=>{if(A.j.deleteRecursive(x),h)switch(e){case M.$.M_INS_SUCCESS:l(" "),l("[93mYou can press the [33;4mbutton[93;0m[93m below to [33;4mreboot[93;0m[93m your device[0m"),m("Reboot",{startIcon:(0,o.jsx)(j.A,{}),onClick:d}),l("[2mModules that causes issues after installing belong not to [35;4mMMRL[0;2m!\nPlease report these issues to their support page[2m"),g&&l(`> [32mIssues: [33m${g}[0m`),p&&l(`> [32mSource: [33m${p}[0m`);break;case M.$.M_INS_FAILURE:l(" "),l("[2mModules that cause issues after installing belong not to [35;4mMMRL[0;2m!\nPlease report these issues to their support page[2m"),g&&l(`> [32mIssues: [33m${g}[0m`),p&&l(`> [32mSource: [33m${p}[0m`);break;case M.$.TERM_INTR_ERR:l("! [31mInternal error![0m");break;default:l(`? Unknown code returned (${e}})`)}r()};try{i.exec(u({ZIPFILE:x}))}catch(e){l(`! [31mExecution error: ${e}[0m`),a(e)}}},f.onError=e=>{n(0),l("! [31mUnable to download the module[0m"),l("! [31mERR: "+e+"[0m"),a(e)},f.start()})),r]})(),[w]=(()=>{const{extra:e}=(0,a.v5)(),[t]=(0,i.t)("print_terminal_error"),{addText:r,addButton:n,rebootDevice:s,getInstallCLI:l}=k(),{modSource:m}=e;return[async e=>new Promise(((a,i)=>{const m=e.file,c=e.printExit??!0,d=new T.B({cwd:"/data/local/tmp",printError:t});d.env={ASH_STANDALONE:"1",MMRL:"true",MMRL_INTR:"true",MMRL_VER:y.P.VERSION_CODE.toString(),ROOTMANAGER:M.$.getRootManager()},d.onLine=e=>{r(e)},t&&(d.onError=e=>{r(`[38;5;130mâ“˜${e}`)}),d.onExit=e=>{if(c)switch(e){case M.$.M_INS_SUCCESS:r(" "),r("[93mYou can press the [33;4mbutton[93;0m[93m below to [33;4mreboot[93;0m[93m your device[0m"),n("Reboot",{startIcon:(0,o.jsx)(j.A,{}),onClick:s}),r("[2mModules that causes issues after installing belong not to [35;4mMMRL[0;2m!\nPlease report these issues to their support page[2m");break;case M.$.M_INS_FAILURE:r(" "),r("[2mModules that causes issues after installing belong not to [35;4mMMRL[0;2m!\nPlease report these issues to their support page[2m");break;case M.$.TERM_INTR_ERR:r("! [31mInternal error![0m");break;default:r(`? Unknown code returned (${e}})`)}a()};try{d.exec(l({ZIPFILE:m}))}catch(e){r(`! [31mExecution error: ${e}[0m`),i(e)}}))]})(),C=x.useCallback((async()=>{const{modSource:e}=t;for(let t=0;t<e.length;t++){const r=e[t],o=t===e.length-1,n=1===e.length||o;try{await v({url:r,printExit:n})}catch(e){console.error("An error occurred during installation:",e)}}}),[]),$=x.useCallback((async()=>{const{modSource:e}=t;for(let t=0;t<e.length;t++){const r=e[t],o=t===e.length-1,n=1===e.length||o;try{await w({file:r,printExit:n})}catch(e){console.error("An error occurred during installation:",e)}}}),[]),N=x.useCallback((e=>{e.preventDefault()}),[]);x.useEffect((()=>{const{exploreInstall:e}=t;return e?C():$(),document.addEventListener("volumeupbutton",N,!1),document.addEventListener("volumedownbutton",N,!1),p.Up.addFlags([p.UD.LayoutParams.FLAG_KEEP_SCREEN_ON]),()=>{document.removeEventListener("volumeupbutton",N,!1),document.removeEventListener("volumedownbutton",N,!1),p.Up.clearFlags([p.UD.LayoutParams.FLAG_KEEP_SCREEN_ON])}}),[]);return(0,o.jsxs)(n.Y,{sx:{pl:1,pr:1,pb:"0px !important"},modifier:"noshadow",renderToolbar:()=>(0,o.jsxs)(s.M,{modifier:"noshadow",sx:{position:"relative !important"},children:[(0,o.jsx)(s.M.Left,{children:(0,o.jsx)(s.M.BackButton,{onClick:e.popPage})}),(0,o.jsx)(s.M.Center,{children:"Install"}),0!==S&&(0,o.jsx)(l.A,{sx:{width:"100%",left:0,right:0,position:"absolute",bottom:0},variant:"determinate",value:S})]}),children:[(0,o.jsx)(m.A,{sx:{display:"flex",flexWrap:"wrap"},children:(0,o.jsx)(c.A,{style:{whiteSpace:_?"unset":"pre",flex:"0 0 100%",color:"white",height:"100%",fontSize:"smaller"},direction:"column",justifyContent:"flex-start",alignItems:"stretch",spacing:0,children:(0,o.jsx)(h(),{list:f,renderItem:(e,t)=>(0,o.jsxs)(m.A,{sx:{display:"flex",":hover":{backgroundColor:(0,d.X4)("#fff",.03)},code:{wordBreak:_?"break-all":"unset"}},children:[I&&(0,o.jsx)(u.A,{sx:e=>({minWidth:"40px",paddingRight:"1em",fontSize:"unset",marginLeft:"calc(18px - 1em)",color:e.palette.text.secondary,textAlign:"right",textDecoration:"none"}),children:Number(t)+1}),(0,o.jsx)(e.component,{...e.props},t)]}),renderOnScroll:!0,renderWhenEmpty:()=>(0,o.jsx)(o.Fragment,{})})})}),(0,o.jsx)(m.A,{sx:{height:p.Up.getWindowBottomInsets()},ref:r})]})},D=()=>(0,o.jsx)(N,{children:(0,o.jsx)(U,{})}),B=D},508330:e=>{e.exports=JSON.parse('{"UU":"com.dergoogler.mmrl.web","$W":{"h$":"3.24.33","br":32433,"n5":[["mmrl","i"],["localhost","i"],["mmrl.dergoogler.com","i"],["dergoogler.com","i"],["dergoogler.github.io","i"],["gr.dergoogler.com","i"],["googlers-repo.github.io","i"],["(localhost|\\\\b(?:(?:25[0-5]|2[0-4]\\\\d|[01]?\\\\d\\\\d?)\\\\.){3}(?:25[0-5]|2[0-4]\\\\d|[01]?\\\\d\\\\d?)(?::\\\\d{0,4})?\\\\b)","g"]]}}')}}]);